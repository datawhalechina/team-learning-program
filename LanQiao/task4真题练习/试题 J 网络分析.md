## 试题 J: 网络分析

时间限制: 1.0s 内存限制: 512.0MB 本题总分：25 分

**【问题描述】**

小明正在做一个网络实验。
他设置了 n 台电脑，称为节点，用于收发和存储数据。
初始时，所有节点都是独立的，不存在任何连接。
小明可以通过网线将两个节点连接起来，连接后两个节点就可以互相通信
了。两个节点如果存在网线连接，称为相邻。
小明有时会测试当时的网络，他会在某个节点发送一条信息，信息会发送
到每个相邻的节点，之后这些节点又会转发到自己相邻的节点，直到所有直接
或间接相邻的节点都收到了信息。所有发送和接收的节点都会将信息存储下来。
一条信息只存储一次。
给出小明连接和测试的过程，请计算出每个节点存储信息的大小。

**【输入格式】**

>  - 输入的第一行包含两个整数 n, m，分别表示节点数量和操作数量。节点从 1 至 n 编号。
>        接下来 m 行，每行三个整数，表示一个操作。
>        如果操作为 1 a b，表示将节点 a 和节点 b 通过网线连接起来。当 a = b 时，表示连接了一个自环，对网络没有实质影响。
>        如果操作为 2 p t，表示在节点 p 上发送一条大小为 t 的信息。

**【输出格式】**

> 输出一行，包含 n 个整数，相邻整数之间用一个空格分割，依次表示进行完上述操作后节点 1 至节点 n 上存储信息的大小。

**【样例输入】**

```python
4 8
1 1 2
2 1 10
2 3 5
1 4 1
2 2 2
1 1 2
1 2 4
2 2 1
```

**【样例输出】**

```python
13 13 5 3
```

**【评测用例规模与约定】**

> 对于 30% 的评测用例，1 ≤ n ≤ 20，1 ≤ m ≤ 100。
>
> 对于 50% 的评测用例，1 ≤ n ≤ 100，1 ≤ m ≤ 1000。
>
> 对于 70% 的评测用例，1 ≤ n ≤ 1000，1 ≤ m ≤ 10000。
>
> 对于所有评测用例，1 ≤ n ≤ 10000，1 ≤ m ≤ 100000，1 ≤ t ≤ 100。

参考答案：

```
n,m=map(int,input().strip().split())
message1=[]
for i in range(m):
    
    or1_2,a,b=input().strip().split()
    message1.append([or1_2,a,b])

    
map_=[[0 for i in range(n)]for i in range(n)]
for i in range(n):
    map_[i][i]=1
    
re=[0 for i in range(n)]

def f(map_,a,b,re,visited):
    for i in range(n):
        if map_[a-1][i]==1:
            if i not in visited:
                f(map_,i+1,b,re,visited|{i})
            else:
                if re[i]==0:
                    re[i]+=b



for or1_2,a,b in  message1:
    a=int(a)
    b=int(b)
    if or1_2=='1':
        map_[a-1][b-1]=1
        map_[b-1][a-1]=1
    else:
        temp=[0 for i in range(n)]
        f(map_,a,b,temp,{a-1})

        for i in range(len(re)):
            re[i]+=temp[i]
        
for i in re:
    print(i)
    
```